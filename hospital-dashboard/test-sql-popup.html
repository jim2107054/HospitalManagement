<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test SQL Popup</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .btn {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .btn:hover {
            background: #5568d3;
        }
        .status {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª SQL Popup Test Page</h1>
        <p>This page tests if the SQL popup modal works correctly.</p>
        
        <div class="status" id="status">
            Status: Ready to test
        </div>
        
        <h3>Test Steps:</h3>
        <ol>
            <li>Click the "Test SQL Popup" button below</li>
            <li>A modal should appear with SQL code</li>
            <li>Click the X button or outside the modal to close it</li>
        </ol>
        
        <button class="btn" onclick="testSQLPopup()">
            <i class="fas fa-code"></i> Test SQL Popup
        </button>
        
        <button class="btn" onclick="checkElements()">
            <i class="fas fa-search"></i> Check Elements
        </button>
    </div>

    <!-- SQL Popup Modal (copied from index.html) -->
    <div id="sql-popup" class="modal-overlay" style="display: none;">
        <div class="modal-content sql-modal">
            <div class="modal-header">
                <h3>SQL Query</h3>
                <button class="modal-close" onclick="closeSQLPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p class="sql-description">SQL query used for current filter:</p>
                <div class="sql-code-container">
                    <pre id="sql-code-display"><code>No query available</code></pre>
                </div>
                <div class="sql-actions">
                    <button class="btn btn-secondary" onclick="copySQLCode()">
                        <i class="fas fa-copy"></i> Copy SQL
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function testSQLPopup() {
            const status = document.getElementById('status');
            status.textContent = 'Opening SQL popup...';
            
            // Set SQL code
            const sqlCode = `SELECT * FROM patients 
WHERE gender = ? 
ORDER BY name ASC 
-- Parameters: ["Male"]`;
            
            const sqlDisplay = document.getElementById('sql-code-display');
            if (sqlDisplay) {
                sqlDisplay.textContent = sqlCode;
                status.textContent = 'SQL code set successfully';
            } else {
                status.textContent = 'ERROR: sql-code-display element not found!';
                return;
            }
            
            // Show popup
            const sqlPopup = document.getElementById('sql-popup');
            if (sqlPopup) {
                sqlPopup.style.display = 'flex';
                status.textContent = 'SQL popup displayed!';
            } else {
                status.textContent = 'ERROR: sql-popup element not found!';
            }
        }
        
        function closeSQLPopup() {
            const sqlPopup = document.getElementById('sql-popup');
            if (sqlPopup) {
                sqlPopup.style.display = 'none';
                document.getElementById('status').textContent = 'SQL popup closed';
            }
        }
        
        function checkElements() {
            const status = document.getElementById('status');
            const sqlPopup = document.getElementById('sql-popup');
            const sqlDisplay = document.getElementById('sql-code-display');
            
            let message = 'Element Check:\n';
            message += `sql-popup: ${sqlPopup ? 'âœ“ Found' : 'âœ— Not Found'}\n`;
            message += `sql-code-display: ${sqlDisplay ? 'âœ“ Found' : 'âœ— Not Found'}`;
            
            status.textContent = message;
            console.log('sql-popup element:', sqlPopup);
            console.log('sql-code-display element:', sqlDisplay);
        }
        
        function copySQLCode() {
            const sqlCode = document.getElementById('sql-code-display').textContent;
            navigator.clipboard.writeText(sqlCode).then(() => {
                alert('SQL code copied to clipboard!');
            }).catch(err => {
                alert('Failed to copy: ' + err);
            });
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('sql-popup');
            if (event.target === modal) {
                closeSQLPopup();
            }
        });
    </script>
</body>
</html>
